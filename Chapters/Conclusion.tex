This document has demonstrated the viability of a cascaded structure for control of the water level of an EWR in a small-scale WDN. Models of the two dynamical regimes of the system have been derived from first principles, and the non-linear regime has been linearised to acquire an LTI model. Based on these models, outer and inner control loops have been designed, employing respectively an optimal VF-LQR strategy with disturbance rejection in the outer loop, and a pair of PI controllers in the inner loop. Furthermore, a harmonic model of consumer behaviour has been developed based on a truncated Fourier series and real consumer data, and an LTI Kalman filter has been designed based on this model. Finally, an analytical result regarding the mean-square stability of an arbitrary EWR under VF-LQR control has been derived.

Experimental results validate the design of the controller, which performs excellently and eventually settles at the specified level reference, and remains stable, in an averaged sense, around the reference after packet loss is introduced. Results have also revealed that performance of the designed control and estimation structure is very sensitive to tuning of respectively the outer loop and Kalman filter, as these may interact as coupled oscillators due to the choice of measurement in the Kalman filter. However, this is expected to be a limited issue in more realistic WDNs - the tank in the laboratory WDN is uncharacteristically small and thus has very fast dynamics relative to the dynamics of the network proper. Furthermore, results reveal that it is likely impossible to design high-quality controllers for the pumps based on simple model linearisation and na√Øve SISO techniques, as cross-coupling between the pumps appears to be lost during the linearisation process, and further study including the application of MIMO control techniques and possibly non-linear or data-driven methods is encouraged by authors.