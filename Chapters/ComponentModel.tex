All components (eg. pipes, valves and pumps) can be described by two variables, namely the flow through the component and the differential pressure across the component:
\begin{equation}
\begin{bmatrix} \Delta{p_{k}} \\ q_{k} \end{bmatrix} = 
\begin{bmatrix} p_{i} - p_{j} \\ q_{k} \end{bmatrix}    
\end{equation}

The following section will examine these two variables for pipes, valves and pumps. We source the equations from \cite{MathiasBjarni2015}.

\subsection{Pipe model}\label{subsec:PipeModel}
The differential pressure across a pipe can be modelled as follows:
\begin{equation}
    \mathrm{\Delta{p_{k}}} = J_{k}\cdot\dot{q_{k}}+\mathrm{\lambda_{k}}(q_{k})-\mathrm{\Delta{z_{k}}}
    \label{eq:Delta_p_pipe}
\end{equation}


	\begin{center}
		\begin{tabular}{l p{10cm} l}
			
			$\Delta{p_{k}}$ & The differential pressure across the $k^{th}$ component & [\si{Pa}]\\ 
		  	${J_{k}}$ & Is the mass inertia of the water in the $k^{th}$ pipe & [\si{kg}/\si{m^{4}}] \\
		  	$q_{k}$ & is the flow of water trough the $k_{th}$ pipe & [{\si{\meter\cubed}/\si{s}}] \\
		  	$\mathrm{\lambda_{k}}(q_{k})$ & is the drop in pressure due to friction in the $k^{th}$ pipe & [\si{Pa}] \\
		  	$\mathrm{\Delta{z_{k}}}$ & is the drop in pressure due to geodesic level & [\si{Pa}]\\
			\end{tabular}
	\end{center}

The mass inertia of water can be describes as follows:
\begin{equation}
	J= \frac{L\cdot \rho}{A}
\end{equation}

	\begin{center}
		\begin{tabular}{l p{10cm} l}
			$L$ & is the length of the pipe & [\si{m}]\\
			$\rho$ & is the density of water & [\si{kg}/\si{m\cubed}]\\  
			$A$ & is the cross sectional area of water & [\si{m\squared}]\\ 
		\end{tabular}
	\end{center}
The cross-sectional area of the pipe is assumed to be constant along the pipe.

The causes of flow friction $\mathrm{\lambda_{k}}(q_{k})$ are surface resistance $h_{f}$ and form resistance $h_{m}$. The surface resistance can be describes with the Darcy-Weisbach equation:

\begin{equation}
	h_{f} = f \cdot \frac{8\cdot L\cdot q^{2}}{\pi^{2}\cdot g \cdot D^{5}}
\end{equation} 

\begin{center}
	\begin{tabular}{l p{10cm} l}
		$h_{f}$ & is the head loss from surface resistance & [\si{m}]\\
		$f$ & is the pipe friction factor & [$\cdot$]\\
		$D$ & is the pipe diameter & [\si{m}]\\
		$g$ & is the gravitational constant & [\si{m}/\si{s\squared}]\\
	\end{tabular}
\end{center}
Under the assumption of turbulent flow $f$ can be is given by:
\begin{equation}
	f=1.325\cdot \Bigg(ln\Big(\frac{\epsilon}{3.7 \cdot D}+\frac{5.74}{R^{0.9}}\Big)\Bigg)^{-2}
\end{equation}

\begin{center}
	\begin{tabular}{l p{8cm} l}
		$\epsilon$ & average height of roughness projection in the pipe & [\si{m}]\\
		$R$ &  is Reynolds number - for turbulent ï¬‚ow $R \geq 4000$ & [$\cdot$]\\
	\end{tabular}
\end{center}

The form resistance can be given by the following:
\begin{equation}
	h_{m}=k_{f}\cdot \frac{8\cdot q^{2}}{\pi^{2}\cdot g \cdot D^{4}}
\end{equation}

\begin{center}
	\begin{tabular}{l p{8cm} l}
		$h_{m}$ & is the head loss from form resistances & [\si{m}]\\
		$k_{f}$ &  is coefficient form loss & [$\cdot$]\\
	\end{tabular}
\end{center}

The drop in pressure due to geodesic level difference:
\begin{equation}
	\Delta{z_{k}} = \rho \cdot g \cdot \Delta{h_{k}}
\end{equation}

\begin{center}
	\begin{tabular}{l p{8cm} l}
		$\Delta{h_{k}}$ &  is the level difference across the terminals of the $k^{th}$ pipe & [\si{m}]\\
	\end{tabular}
\end{center}

Having explained all the components of \eqref{eq:Delta_p_pipe} a complete expression can now be formulated; we take advantage of the fact that resistance losses are expressed in terms of head, and can be expressed in terms of pressure by multiplying by $\rho$ and g. \begin{equation}
	p = \rho \cdot g \cdot h  
\end{equation}

Meaning that the head losses can be expressed in terms of pressure by the following:

\begin{equation}
\lambda_{k}(q_{k})  =	\Big(f \cdot \frac{8\cdot L\cdot q^{2}}{\pi^{2}\cdot g \cdot D^{5}} + k_{f}\cdot \frac{8\cdot q^{2}}{\pi^{2}\cdot g \cdot D^{4}}\Big)\cdot g \cdot \rho
\end{equation}

Inserting and reducing into \cref{eq:Delta_p_pipe}

\begin{equation}
	\Delta{p_{k}} = \frac{L\cdot \rho}{A}\cdot \dot{q_{k}}
	+\Big(f \cdot \frac{8\cdot L\cdot \rho}{\pi^{2} \cdot D^{5}} + k_{f}\cdot \frac{8\cdot \rho}{\pi^{2} \cdot D^{4}}\Big)\cdot |q_{k}|\cdot q_{k} 
	- \rho \cdot g \cdot \Delta{h_{k}} = \mathcal{J}\dot{q} + \lambda(q) + \Delta z
\end{equation}

The absolute value of one of the flow component in $q^{2}$ is taken to preserve the flow direction.


\subsection{Valve model}\label{subsec:ValveModel}

While the head loss of a valve \textit{can} be explained in terms of its form resistance, as we have done previously in \cref{subsec:PipeModel}, it is generally impractical to determine the form loss coefficient $k_f$ for valves. Instead, an expression for the head loss can be derived - typically by the manufacturer - via a conductivity function $K_{valve}(OD)$.

\smallskip

Recalling that the pressure drop across a valve is proportional to its squared flow, we may express that:

\begin{equation}\label{eq:HydrodynamicRatio}
	\frac{\Delta p_1}{q_1^2} = \frac{\Delta p_2}{q_2^2} \Leftrightarrow 
	\frac{\Delta p_1}{\Delta p_2} = \frac{q_1^2}{q_2^2}
	\Leftrightarrow
	q_1 = q_2\cdot\sqrt{\frac{\Delta p_1}{\Delta p_2}}
\end{equation}

We then express the conductivity function $K_{valve}(OD)$ as, by convention, as corresponding to the flow $q_n$ at a given opening degree that produces exactly a pressure differential of 1 bar, i.e.:

\begin{equation}\label{eq:Kvalve}
	q = q_n(OD)\cdot\sqrt{\frac{\Delta p_1}{1}} = K_{valve}(OD)\cdot\sqrt{\Delta p_1}
\end{equation}

We can then express the pressure differential across the valve for a given flow as:

\begin{equation}\label{eq:ValvePressure}
	 q = K_{valve}(OD)\cdot\sqrt{\Delta p_1}
	 \Leftrightarrow
	 \Delta p_1 = \frac{1}{K_{valve}(OD)^2} \cdot |q|\cdot q = \mu(q,OD)
\end{equation}

where $q^2 \equiv |q|\cdot q$ is introduced to preserve the directionality of flow. Note that \cref{eq:ValvePressure} implies the pressure differential across the pipe varies with both flow rate \textit{and} opening degree.

\smallskip

$K_{valve}(OD)$ may take a variety of forms, but is typically either linear, equal-percentage, or quick-opening.

\subsection{Pump model}\label{subsec:PumpModel}

The pressure differential across a centrifugal pump, such as the pumps used in this project, is a multivariable function that can generally be approximated by a polynomial expression of the form:

\begin{equation}\label{eq:PumpPressure}
	\Delta p =   a_0\cdot \omega^2 +  a_1\cdot \omega \cdot q -a_2\cdot |q|\cdot q
\end{equation}

where $[a_0,a_1,a_2]$ is a tuple of coefficients that describe the pump's characteristic curve, $q$ is the flow rate through the pump, and $\omega$ is the rotational velocity of the pump.

\subsection{Elevated water reservoir model}

In this section we will develop a hydraulic model of an elevated fluid reservoir, also known as a tank.
Under assumption that the cross-sectional area of the tank is constant along its height axis, the pressure at the bottom of the tank is proportional to the fluid level in the tank:

\begin{equation} \label{eq:p prop zeta}
	p_\tau \propto \zeta
\end{equation}

The volumetric rate of change is equal to the flow in and out of the tank:

\begin{equation} \label{eq:vdot = dt}
	\dot{V} = d_\tau
\end{equation}

Logically, the rate of fluid level change is proportional to the volumetric rate of change:  
 
 \begin{equation} \label{eq:zeta prop dt}
	\dot{\zeta} \propto \dot{V} \Leftrightarrow \dot{\zeta} \propto d_\tau
\end{equation} 

From above it can be concluded that the rate of change of pressure is proportional to flow in and out of the tank:

\begin{equation} \label{eq:dotp prop dt}
	\dot{p}_{\tau} \propto d_\tau 
\end{equation}

Defining the proportionality constant $\tau$ and taking flow out of the tank as positive:

\begin{equation} \label{eq:dpTank}
	\dot{p}_{\tau}=-\tau \cdot d_{\tau} 
\end{equation} 

\begin{center}
	\begin{tabular}{l p{10cm} l}
		$p_\tau$ & is the pressure at the node connected to the bottom of the tank & [\si{Pa}]\\
		$\tau$ & is the tank parameter which depends on the cross sectional area of the tank & [\si{Pa}/\si{m\cubed}]\\
		$d_\tau$ & is the water flow in and out of the tank. If $q > 0$ water is flowing out of the tank, if $q < 0$ water is flowing into the tank. & [\si{m\cubed}/\si{s}] 
		\end{tabular}
\end{center}

The tank parameter is given by:
\begin{equation}\label{eq:TankParameter}
\tau = \rho \cdot g \frac{1}{A}
\end{equation}
 
